<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Gi·ªè h√†ng</title>
  <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Be Vietnam Pro', sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f9f9f9;
      color: #333;
    }

    h2 {
      margin-bottom: 20px;
    }

    .container {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
    }

    .cart-left, .cart-right {
      flex: 1;
      min-width: 320px;
      background-color: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }

    .cart-item {
      display: flex;
      gap: 15px;
      align-items: flex-start;
      margin-bottom: 20px;
      border-bottom: 1px solid #eee;
      padding-bottom: 15px;
    }

    .cart-item img {
      width: 90px;
      height: 90px;
      border-radius: 8px;
      object-fit: cover;
      border: 1px solid #ddd;
    }

    .cart-item .info {
      flex: 1;
    }

    .cart-item .info p {
      margin: 5px 0;
    }

    .price {
      color: #e74c3c;
      font-weight: 600;
    }

    .quantity-control {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 8px;
    }

    .quantity-control button {
      padding: 4px 10px;
      border: none;
      background-color: #e0e0e0;
      border-radius: 4px;
      cursor: pointer;
    }

    .quantity-control button:hover {
      background-color: #ccc;
    }

    .section-title {
      font-weight: 600;
      margin-top: 10px;
      font-size: 18px;
    }

    input, select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-bottom: 15px;
      font-size: 14px;
    }

    .summary {
      border: 1px solid #e74c3c;
      padding: 20px;
      border-radius: 10px;
      background-color: #fffaf9;
    }

    .summary h3 {
      margin-top: 0;
      font-size: 18px;
      margin-bottom: 15px;
    }

    .summary p {
      display: flex;
      justify-content: space-between;
      margin: 6px 0;
      font-size: 14px;
    }

    .btn {
      padding: 12px 20px;
      background-color: #e74c3c;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      margin-top: 20px;
    }

    .btn:hover {
      background-color: #c0392b;
    }

    .text-note {
      font-size: 12px;
      color: #555;
      margin-top: 10px;
    }

    .cart-empty {
      font-style: italic;
      color: #888;
    }
  </style>
</head>
<body>

<div class="container">
  <div class="cart-left">
    <h2>üõí Gi·ªè h√†ng c·ªßa b·∫°n</h2>
    <div id="cartList" class="cart-list"></div>
    <button onclick="location.href='index.html'" class="btn">‚Üê Ti·∫øp t·ª•c xem s·∫£n ph·∫©m</button>
  </div>

  <div class="cart-right">
    <div class="section-title">Th√¥ng tin thanh to√°n</div>
    <input placeholder="H·ªç v√† t√™n" id="customerName">
    <input placeholder="ƒê·ªãa ch·ªâ giao h√†ng" id="customerAddress">
    <input placeholder="S·ªë ƒëi·ªán tho·∫°i" id="customerPhone">
    <input placeholder="Zalo ho·∫∑c email" id="customerContact">
    <input placeholder="Link Facebook h·ªó tr·ª£ b·∫£o h√†nh" id="customerFB">
    <select id="paymentMethod">
      <option value="">Ph∆∞∆°ng th·ª©c thanh to√°n</option>
      <option value="cod">Thanh to√°n khi nh·∫≠n h√†ng (COD)</option>
      <option value="bank">Chuy·ªÉn kho·∫£n ng√¢n h√†ng</option>
    </select>

    <div class="summary">
      <h3>üì¶ ƒê∆°n h√†ng</h3>
      <div id="summaryItems"></div>
      <p><strong>T·ªïng ph·ª•:</strong> <span id="subtotal">0ƒë</span></p>
      <p><strong>T·ªïng c·ªông:</strong> <span id="total">0ƒë</span></p>
      <label><input type="radio" checked> Chuy·ªÉn kho·∫£n ng√¢n h√†ng</label>
      <p class="text-note">Vui l√≤ng s·ª≠ d·ª•ng M√£ ƒë∆°n h√†ng c·ªßa b·∫°n trong n·ªôi dung chuy·ªÉn kho·∫£n. ƒê∆°n h√†ng s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω sau khi thanh to√°n th√†nh c√¥ng.</p>
    </div>

    <button class="btn" onclick="submitOrder()">‚úÖ X√°c nh·∫≠n ƒë·∫∑t h√†ng</button>
  </div>
</div>

<script>
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  const cartList = document.getElementById("cartList");
  const summaryItems = document.getElementById("summaryItems");
  let subtotal = 0;

  if (cart.length === 0) {
    cartList.innerHTML = "<p class='cart-empty'>Hi·ªán kh√¥ng c√≥ s·∫£n ph·∫©m n√†o trong gi·ªè h√†ng.</p>";
  } else {
    cartList.innerHTML = cart.map((item, index) => {
      subtotal += item.total;
      return `
        <div class="cart-item">
          <img src="${item.image}" alt="${item.title}">
          <div class="info">
            <p><strong>${item.title}</strong></p>
            <p>Lo·∫°i: ${item.productOption === 'only-clothes' ? 'Ch·ªâ qu·∫ßn √°o' : 'Set qu√†'}</p>
            <p>Size: ${item.size}</p>
            <p>Gi√°: <span class="price">${item.price.toLocaleString()}ƒë</span></p>
            <div class="quantity-control">
              <button onclick="updateQty(${index}, -1)">-</button>
              <span>${item.quantity}</span>
              <button onclick="updateQty(${index}, 1)">+</button>
              <button onclick="removeItem(${index})">üóë</button>
            </div>
          </div>
        </div>
      `;
    }).join("");

    summaryItems.innerHTML = cart.map(item =>
      `<p>${item.title} (${item.productOption === 'only-clothes' ? 'Ch·ªâ qu·∫ßn √°o' : 'Set qu√†'}) √ó ${item.quantity}<span>${item.total.toLocaleString()}ƒë</span></p>`
    ).join("");

    document.getElementById("subtotal").textContent = subtotal.toLocaleString() + 'ƒë';
    document.getElementById("total").textContent = subtotal.toLocaleString() + 'ƒë';
  }

  function updateQty(index, delta) {
    cart[index].quantity = Math.max(1, cart[index].quantity + delta);
    cart[index].total = cart[index].quantity * cart[index].price;
    localStorage.setItem("cart", JSON.stringify(cart));
    location.reload();
  }

  function removeItem(index) {
    cart.splice(index, 1);
    localStorage.setItem("cart", JSON.stringify(cart));
    location.reload();
  }

  function submitOrder() {
    const name = document.getElementById("customerName").value.trim();
    const address = document.getElementById("customerAddress").value.trim();
    const phone = document.getElementById("customerPhone").value.trim();
    const contact = document.getElementById("customerContact").value.trim();
    const fb = document.getElementById("customerFB").value.trim();
    const payment = document.getElementById("paymentMethod").value;

    if (!name || !address || !phone || !payment) {
      alert("Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc!");
      return;
    }

    const order = {
      items: cart,
      customer: { name, address, phone, contact, fb, payment },
      total: subtotal
    };

    console.log("ƒê∆°n h√†ng g·ª≠i:", order);

    alert("C·∫£m ∆°n b·∫°n ƒë√£ ƒë·∫∑t h√†ng! Th√¥ng tin ƒë∆°n h√†ng ƒë√£ ƒë∆∞·ª£c l∆∞u.");
    localStorage.removeItem("cart");
    location.reload();
  }
</script>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCR6ChodbxTFeMqVEfc37LGMZn0sRKyl-k",
      authDomain: "loichucyeuthuong18.firebaseapp.com",
      databaseURL: "https://loichucyeuthuong18-default-rtdb.firebaseio.com", // <--- ƒë√∫ng
      projectId: "loichucyeuthuong18",
      storageBucket: "loichucyeuthuong18.appspot.com",
      messagingSenderId: "434140825017",
      appId: "1:434140825017:web:13deda5e05e22fe2f76268"
    };


    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
  </script>

  <script>
    function submitOrder() {
      const name = document.getElementById("customerName").value.trim();
      const address = document.getElementById("customerAddress").value.trim();
      const phone = document.getElementById("customerPhone").value.trim();
      const contact = document.getElementById("customerContact").value.trim();
      const fb = document.getElementById("customerFB").value.trim();
      const payment = document.getElementById("paymentMethod").value;

      if (!name || !address || !phone || !payment) {
        alert("Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc!");
        return;
      }

      const timestamp = new Date().toISOString(); // th·ªùi gian ISO

      const order = {
        items: cart,
        customer: { name, address, phone, contact, fb, payment },
        total: subtotal,
        status: "pending",
        createdAt: timestamp
      };

      // L∆∞u v√†o Firebase
      db.ref("orders").push(order)
        .then(() => {
          alert("ƒê∆°n h√†ng ƒë√£ ƒë∆∞·ª£c g·ª≠i th√†nh c√¥ng!");
          localStorage.removeItem("cart");
          location.reload();
        })
        .catch(error => {
          console.error("L·ªói khi l∆∞u ƒë∆°n h√†ng:", error);
          alert("C√≥ l·ªói x·∫£y ra. Vui l√≤ng th·ª≠ l·∫°i.");
        });
    }
    </script>





</body>
</html>
